---
author: "Certseeds"
date: "2023-02-18"
title: "管理你的邮箱"
description: "manage your mails in local opensource-mailbox"
tags: ["mails","experience","open-source"]
---

# 管理你的邮箱

已经高频次的使用邮箱很长时间了, 近期陆续对邮箱进行了清理, 归档与备份, 写篇文章记录一下.

## 简单描述遇到的现状

### 空间不足

免费的邮箱总有一个容量上限, gmail免费给出15G, tencent-exmail给出的则是4G. 这些空间很容易被大的无厘头的邮件占满, 80封50M的邮件就能够耗尽tencent-exmail的存储空间, gmail也就那样, 15G,300封, 这也是有限的.

归根到底, 问题在于发信人发信时, 发信体积并不在他的KPI中, 他没有动力像前端/客户端一样去做体积优化/包体优化, 导致高频发邮件方的行为收敛到了把大图片放到邮件中,以此来提高点击率, 提高目的达成率.

## 邮件过多带来的性能问题

### thunderbird的性能问题

thunderbird(一个基于firefox的开源邮件管理工具)会把一个文件夹内的所有邮件分成两个文件来管理, 一个存储元数据(索引?), 另一个存储所有的正文.
由于划分的这么简单, 当邮箱里存了太多邮件, 或者是混入了大体积邮件时, 它们堆叠起来, 导致正文-文件体积膨胀(可以达到10GB这个水平), 直接导致对邮件进行管理时出现卡顿, 不跟手等现象, 很影响心情.

PS: thunderbird可以非常简单的将邮件一封一封的导出成eml, 全选邮件另存为就完事, 它们为什么不将其作为默认的存储方式呢?

### 邮箱网页端的性能问题

网页端的主要问题在于需要分页, 并且在选择"选择所有邮件"的时候性能并不是那么好, 有时操作过后也没什么效果, 如果可能的话, 单个文件夹保存能够一页加载完的数量最好(100个左右).

PS: 正如上文说的发信者KPI, 那里面同样没有发信数量这个值, 它们会倾向于滥发邮件来达成目的.

## 介绍归档以及本地归档

归档这个动作类比到文书工作里, 可以比作成把签好的文档归纳到收纳柜里, 这些文件已经不在会被经常访问, 虽然还需要保留着它们以备不测, 但是不需要再让他们在桌面上占据空间了.

归档操作可以按时间来, 固定将一段时间之前的邮件归档掉; 也可以选择处理完毕立马归档.

### 邮箱网页上的归档

在网页版的邮箱里面也有归档,一般作为处理完成的标记.

+ Gmail的归档最为直接(也饱受诟病), 会把邮件转移到"所有邮件"标签里面.
+ outlook的归档有单独的标签, 归完档会进入单独的归档标签.

但是如果可能的话, 最好在归档里面保有外面相同的结构, 这样更加方便理解, 收纳柜上也得贴标签, 不能只有起始时间终止时间.

### thunderbird的本地归档

thunderbird的归档默认也是在server上建一个大目录来放所有归档的邮件, 这虽然和大邮件提供商使用的默认方式一样, 但是就上面所说的实现来看, 这样会有灾难性的后果, 本地整出来好几十G的大文件都有可能.
好在可以选择在本地目录归档, 将邮件在本地归档后相当于在服务器上删除掉, 之后还能导入, 方便优化邮箱体积.

thunderbird的本地归档外层可以选择不分时间-年份-年份+月度三级, 内层可以选择保有原有结构, 这样划分清楚备份起来更容易一些, 分拆出来也能避免巨大文件的出现.

在本地归档之后, 产出的归档文件夹可以直接被用来备份用, 无论是打包成tar.gz,还是用git来管理都很方便.

## 为什么应该使用邮箱客户端

虽然gmail, outlook的web都做得还可以, 收-发邮件都行, 但是还是有必须继续使用邮箱客户端(mobile,pc都一样).

### 聚合邮件

只要是个客户端,就能登陆多个账号, 一次配置长期有效, 比web登录要简单非常多, 开的页面少了, 也不用输验证码之类的了.

### 时效性

客户端可以弹窗提醒, 可以发出声音, 可以挂在后台定制执行, 比定时去邮箱里手动查要好太多了(太长时间没动容易被踢下线, 还得登录)

### 本地备份

客户端一般提供了完善的导出机制, 可以如上文所说, 将邮件本地归档, 也可以多选导出eml. 以便对接另外的备份平台

### 非对称加密

非对称加密的经典实践要求子密钥保存在独立设备中, 比如yubikey, 也需要从其他人的邮件附件中提取公钥, 必要时手动对公钥进行导入更新.
这些都比较适合客户端, web上直接读yubikey还是不太常见, 让客户端去负责和gnupg交互比较容易实现, 维护公钥列表也是用文件的方式最方便.

## 介绍邮件分类器

简单介绍一些常见的邮件分类逻辑, 方便在邮箱里面设置过滤器, 实现预分拣.

PS: 把过滤器建立在server上比较方便, 直接收取就行; 本地还得和服务器同步.
PS2: 如果能把本地的过滤器规则搞成DSL, 并且能同步到server上就好了.

### 大文件夹

正如上文提到的, 邮件发送者会倾向于发送大体积的邮件, 很浪费空间, 因此无论是采用哪一类逻辑, 都应该把这些邮件给筛选出来, 存储在独立的位置.

虽然没有经过数据分析, 但是我猜测邮件体积大概也遵循28定律, 20%邮件占据了80%的体积, 有大量小邮件只是一些html+纯文本, 单个体积很小, 几千封也没什么问题; 也有不少的大文件一个几十兆, 抓住这些文件就能从很大程度上解决问题.

### 按主题取分

+ 会议通知(通常有大附件...)
+ 私人
+ 银行账单
+ 朋友生日
+ etc...

### 按重要-紧急来划分

或者可以按重要-紧急的维度, 把邮件归纳到下面四种目录里面.

|        | 重要  | 不重要 |
| :----: | :---: | :----: |
|  紧急  |       |        |
| 不紧急 |       |        |

这样搞可能比较适合于和时效性紧密相关的收件人(告警邮件), 定期发送的邮件(每日监控), 其他的得手动一点点调试

### 总结自己的规律

不管怎样, 邮箱是自己的, 会收到五花八门的邮件, 会注册正经或者不正经的服务, 每条规律都得自己总结, 从开始时的全在收件箱, 到最后分门别类的归纳.

## 小trick

gmail可以设置alias, gmail会忽略`+`之后的任意字符, 以及名字里的`.`字符, 很适合用于注册.

## conclusion

Inbox里的一封几封邮件看起来人畜无害, 随着时间过去, 当邮箱一共一千封, 一万封邮件, Inbox每天收入几十封邮件的时候, 对它们进行有效的预处理和处理后归档,就变成了必须要妥善考虑的事.
